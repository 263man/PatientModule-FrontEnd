# FHIR-Enabled Patient Management System

## 1. Executive Summary

The **FHIR-Enabled Patient Management System** is a full-stack healthcare application demonstrating secure, standards-based patient data management using modern web technologies.  
It features a **React (Vite) frontend** and an **ASP.NET Core 8 backend API** integrated with a live **HAPI FHIR R4 server**, providing real-time interoperability in compliance with healthcare data exchange standards.

This project serves as a **demonstration of FHIR integration, secure authentication, CRUD operations, and CI/CD automation**, making it an ideal portfolio and learning reference for healthcare application development.

Frontend repo: https://github.com/263man/PatientModule-FrontEnd.git
Backend repo: https://github.com/263man/PatientModule-BackEnd.git


---

## 2. System Overview

| Layer | Technology | Purpose |
|-------|-------------|----------|
| **Frontend** | React 18 + Vite + Tailwind CSS | Provides a responsive UI for patient record management |
| **Backend** | ASP.NET Core 8 Web API | Serves patient data, handles authentication, and integrates with FHIR |
| **Database** | Microsoft SQL Server | Stores local application data (users, audit logs, FHIR references) |
| **FHIR Integration** | Hl7.Fhir.R4 Client | Enables CRUD operations against live HAPI FHIR server (`http://hapi.fhir.org/baseR4`) |
| **Authentication** | ASP.NET Core Identity + JWT | Secures API endpoints with token-based authentication |
| **Logging** | Serilog | Captures structured logs to file and console |
| **Deployment** | Docker + GitHub Actions + InterServer Plesk | Fully automated CI/CD pipeline for API and frontend |
| **Encryption** | AES-256 | Protects sensitive local data fields |

---

## 3. High-Level Architecture Diagram

pgsql
Copy code
            ┌─────────────────────────────────────┐
            │        React Frontend (Vite)        │
            │  - Tailwind UI                      │
            │  - Auth (JWT stored in memory)      │
            │  - Patient CRUD (via Fetch API)     │
            └───────────────┬─────────────────────┘
                            │ HTTPS / REST (JWT)
                            ▼
            ┌─────────────────────────────────────┐
            │       ASP.NET Core 8 API Layer      │
            │-------------------------------------│
            │ Controllers:                        │
            │  - AuthController                   │
            │  - PatientsController               │
            │-------------------------------------│
            │ Services:                           │
            │  - PatientService                   │
            │  - FhirService (Hl7.Fhir.R4)        │
            │  - EncryptionService (AES-256)      │
            │  - AuditLogService                  │
            │-------------------------------------│
            │ Entity Framework Core + SQL Server  │
            └───────────────┬─────────────────────┘
                            │
                            ▼
            ┌─────────────────────────────────────┐
            │         HAPI FHIR Server (R4)       │
            │ http://hapi.fhir.org/baseR4         │
            │ Stores and retrieves FHIR resources │
            └─────────────────────────────────────┘
markdown
Copy code

---

## 4. Backend Component Breakdown

### 4.1 Controllers
- **AuthController**  
  - Handles user registration, login, and JWT generation.
  - Uses ASP.NET Core Identity for secure credential storage.

- **PatientsController**  
  - Exposes CRUD endpoints for patient data.  
  - Synchronizes data between SQL Server (local metadata) and HAPI FHIR (clinical data).

### 4.2 Core Services
- **FhirService**  
  - Wraps the `Hl7.Fhir.Rest.FhirClient` for live communication with the FHIR server.  
  - Implements:
    - `CreatePatientAsync()`
    - `GetPatientAsync()`
    - `UpdatePatientAsync()`
    - `DeletePatientAsync()`
    - `SearchPatientsAsync()`

- **PatientService**  
  - Coordinates between local DB and FHIR layer.  
  - Handles patient encryption/decryption before saving locally.

- **EncryptionService**  
  - Uses AES-256 symmetric encryption for sensitive data fields.

- **AuditLogService**  
  - Logs user actions (create, update, delete) with timestamps and user identifiers.

### 4.3 Data Layer
- **TelehealthDbContext** (Entity Framework Core)
  - Tables: `Patients`, `AuditLogs`, `AspNetUsers`
  - Tracks metadata such as FHIR Resource IDs for cross-reference.

---

## 5. Frontend Component Breakdown

### 5.1 Key Features
- JWT-based login (with `authService.js`)
- Patient CRUD UI (list, add, edit, delete)
- Search, filter, and pagination
- Responsive layout using Tailwind CSS
- React Context for global auth and data state

### 5.2 Structure
src/
├── components/ # Reusable UI components (PatientForm, PatientTable, LoginForm)
├── context/ # AuthContext and PatientContext
├── services/ # API integration (authService.js, patientService.js)
├── hooks/ # Custom React hooks
├── App.jsx # Main app component
└── main.jsx # Entry point

yaml
Copy code

---

## 6. Data Model Overview

### 6.1 Local Database (SQL Server)
| Table | Key Fields | Purpose |
|--------|-------------|----------|
| **Patients** | Id, FhirId, FullName (encrypted), Email, BirthDate | Local mirror of FHIR patients |
| **AuditLogs** | Id, UserId, Action, Timestamp | Tracks operations for compliance and monitoring |
| **AspNetUsers** | Id, Email, PasswordHash, etc. | ASP.NET Core Identity storage |

### 6.2 FHIR Resource Mapping (Patient)
| FHIR Field | Local Field | Notes |
|-------------|-------------|-------|
| `Patient.id` | `FhirId` | FHIR resource identifier |
| `Patient.name.family` | `FullName` | Encrypted locally |
| `Patient.telecom.value` | `Email` | Used for uniqueness |
| `Patient.birthDate` | `BirthDate` | Stored as ISO-8601 string |

---

## 7. API Endpoint Overview (Simplified)

| Method | Endpoint | Description |
|--------|-----------|-------------|
| `POST` | `/api/auth/register` | Register a new user |
| `POST` | `/api/auth/login` | Authenticate user and issue JWT |
| `GET` | `/api/patients` | Retrieve paginated list of patients |
| `GET` | `/api/patients/{id}` | Retrieve a specific patient |
| `POST` | `/api/patients` | Create a new patient (syncs to FHIR) |
| `PUT` | `/api/patients/{id}` | Update existing patient (syncs to FHIR) |
| `DELETE` | `/api/patients/{id}` | Remove patient (syncs to FHIR) |

---

## 8. Security Architecture

| Aspect | Implementation |
|---------|----------------|
| **Authentication** | JWT Bearer Tokens with ASP.NET Core Identity |
| **Authorization** | Generic user access (future-ready for role-based access) |
| **Data Encryption** | AES-256 for sensitive fields in local DB |
| **Transport Security** | HTTPS enforced in production |
| **Audit Logging** | Every CRUD operation recorded with timestamp and user ID |
| **CORS** | Restricted to `https://patients.kepekepe.com` frontend origin |

---

## 9. CI/CD Pipeline

### 9.1 Backend (`.github/workflows/deploy-backend.yml`)
- Trigger: Push to `main`
- Steps:
  1. Setup .NET SDK 8
  2. Restore dependencies, build, and publish
  3. Deploy via FTP to Plesk server at `patientsapi.kepekepe.com`
- Secrets:
  - `FTP_SERVER`, `FTP_USERNAME`, `FTP_PASSWORD`, `FTP_TARGET_DIR`

### 9.2 Frontend (`.github/workflows/deploy-frontend.yml`)
- Trigger: Push to `main`
- Steps:
  1. Setup Node.js
  2. Install dependencies and build Vite app
  3. Deploy `/dist` directory via FTP to `patients.kepekepe.com`
- Environment:
  - `.env` with `VITE_API_BASE_URL=https://patientsapi.kepekepe.com`

---

## 10. Logging and Monitoring

- **Serilog** configured for console + file output (`logs/application.log`)
- Audit logs stored in database for traceability
- Potential extensions:
  - Remote logging (Seq, ELK)
  - Health checks at `/healthz`

---

## 11. Non-Functional Requirements

| Category | Requirement |
|-----------|--------------|
| **Performance** | Average API response < 200ms for standard CRUD operations |
| **Scalability** | Docker-ready for containerized deployments |
| **Availability** | CI/CD ensures zero manual deployment downtime |
| **Security** | JWT + AES-256 + HTTPS |
| **Compliance** | Demonstrates FHIR R4 interoperability and audit tracking |

---

## 12. Future Enhancements

- Implement role-based authorization (Admin, Clinician)
- Add appointment and encounter resources
- Integrate patient search by multiple FHIR parameters
- Enable offline/local FHIR caching
- Include live monitoring dashboard via Seq or Grafana

---

## 13. Conclusion

The **FHIR-Enabled Patient Management System** showcases a modern healthcare application architecture integrating real-world interoperability (FHIR R4) with secure, maintainable software design.  
It serves as a live, demonstrable proof-of-concept for secure patient data management in compliance with healthcare data standards, ideal for portfolio display and professional FHIR project references.

---

**Repository URLs:**
- **Frontend:** [https://patients.kepekepe.com](https://patients.kepekepe.com)  
- **Backend API:** [https://patientsapi.kepekepe.com](https://patientsapi.kepekepe.com)

**License:** MIT
